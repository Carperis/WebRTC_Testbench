import textwrap
colors = {
    # 'black': '\033[30m',
    'red': '\033[31m',
    'green': '\033[32m',
    'yellow': '\033[33m',
    'blue': '\033[34m',
    'magenta': '\033[35m',
    'cyan': '\033[36m',
    # 'white': '\033[37m',
    'reset': '\033[0m'
}


def highlight_common_sequences(string1, string2, n):
    out1 = string1
    out2 = string2
    common_sequences = []

    i = 0
    while i < len(string1)-n:
        match_flag = False
        match_flag_old = False
        for j in range(i + n - 1, len(string1)):
            sequence = string1[i:j+1]
            match_flag_old = match_flag
            if sequence in string2:
                match_flag = True
                if (match_flag and j == len(string1)-1):
                    common_sequences.append(sequence)
                    break
            else:
                match_flag = False
                if (match_flag_old and not match_flag):
                    common_sequences.append(string1[i:j])
                break
        if (match_flag):
            i = j + 1
        elif (match_flag_old):
            i = j
        i += 1

    i = 0
    numofcolors = 6
    for sequence in common_sequences:
        color = list(colors.keys())[i % numofcolors]
        out1 = out1.replace(
            sequence, get_colored_text(sequence, color))
        out2 = out2.replace(
            sequence, get_colored_text(sequence, color))
        i += 1

    return out1, out2


def get_colored_text(text, color):
    if color in colors:
        colored_text = f"{colors[color]}{text}{colors['reset']}"
        return colored_text
    else:
        return text

# def print_six_columns(string):
#     columns = [string[i:i+2] for i in range(0, len(string), 2)]
#     rows = [columns[i:i+6] for i in range(0, len(columns), 6)]

#     for row in rows:
#         formatted_row = ' '.join(row)
#         print(formatted_row)


def print_six_columns(string):
    columns = textwrap.wrap(string, 2)
    rows = textwrap.wrap(' '.join(columns), 48)

    for row in rows:
        print(row)


binding_request = "dceb690a884d2c8db1739452080045000080c18f0000801100000a0000bf4216d487ec3dc356006c21da000100502112a44254355157556d705736457274000600097a5267393a41777758000000c0570004000003e7802a000859864e73f6de964100250000002400046e001eff00080014a573c50e9fd9faebedd9854516f4ef6377f3f5ea80280004cdb53c31"
binding_success_response = "2c8db1739452dceb690a884d08004500006c7c0740003711a61d4216d4870a0000bfc356ec3d0058878a0101003c2112a44254355157556d705736457274002000080001cd2f6802b9b8000600097a5267393a4177775820202000080014f67672f19152ab35ccba48b4e2fbdcb9e464555c8028000442375a27"
udp1 = "dceb690a884d2c8db173945208004500011ec1950000801100000a0000bf4216d487ec3dc356010a227890ef1b512374d809907f173ebede000231000110b70000005ac7809216493a82ae8b4b061fc9ddad74e8542fb5cdc5a5972e3eb2adc4310728700334f54484a4f32cce3fbcbad80d3f1ba5c44672b42b25abc42117a57ba8108641b4e4e5ae4a7549bca2ff2207935b6d04a99fe53317b34fb87b1c73c8b47822193cd367f0ecefc10bc10fd85efec0879490c03b6e95e8d4a4c3d489f5c4c705db308c7dfd449d8af8a4fd3eef90a081e33838ebefe013eeab06e1e4f2206c0663473d840bf85a1d43fd6e640a9f5842258254f231c18d905a6b5c1e9ed97dc98cfb5341ca761ca40fdb62c4ab8b1db519d11d1b708232da1a951f3304f71bdae243aef5ec1cf486"
udp2 = "dceb690a884d2c8db173945208004500011ac1960000801100000a0000bf4216d487ec3dc35601062274b06f1b522374d809907f173ebede00013100020010ca3dd9badf68f483df0e6623af664f758da34715339a4bdb767906813344aeaa27070108c6851d8fccb754c888184d6399a7ca53c4698de9357367b74a65cc44e5b29953ffb6e003ddf48016e90191575f373681a272ae802dfb858b8bd10ea7a1e785280776df4c50f27963e3b27d2136ea8f7d18a278be2213aeb5e13bf725fcb73d6633110073123889718be2598d308112b14b718eaed6aef4c401dc58c9a9b60faa7cc5c5cb3f61cfafb6b6ab6b4266190eaea3341a216a54fefd83b22a425725e31ac4994797c88d3c21bb17949458646915598ba245230ee7a739b208e8947407d1b4150cc4"
udp3 = "dceb690a884d2c8db173945208004500011ac1970000801100000a0000bf4216d487ec3dc35601062274b06f1b532374d809907f173ebede00013100030007e58c674073ad3c756ffac22f7fb7f5c8099a1532151130ae6922a4cc7c3134ded58bec957c613e1cc4fc6aaa292d6db76e2c49d00d2c8f5ea3076e3eb766196390b84fcff44c4b44a5b4b10736ddb80f692dcf85f6808402e781827e25731fe41e9dcf4be33fe69f9025eb9dcbaab1c79f115034a00668be37846215dc1b85d2d5fcb0a292b243e929942ba5560a7851c0ebbbea2ce994555b18e588c2db22d59ab1b3a3cdff1a1f01172c9880f3338b576cf641906c1ce8883b68c4e4d5d90eb8dd12d9575c11ae9cca3625ba38fdaf39d949431c2a9c152f9f849f63193c73fd848aefe12edf7458"
udpn = "dceb690a884d2c8db17394520800450000dfc1c00000801100000a0000bf4216d487ec3dc35600cb2239906f1b7c23753989907f173ebede000231002c10da000000ad384537caabd0b44f9987ff104cec01c0441f8ef4188d014a71b2b22bcd9468c61a478c06461f4c80f52a1d5b3dec305b7121daabb5bb3160982036d5c3215f174e6bae02f54d1be79ff1a35972855dde485c5f06b8a067d21ec3a3eac5b19710040632055a690e52af210469d7c93a1a22f14b4e58ee8569b201931b941cfc4a186faed6d9211ab6d08c951f277c82a544549f6634dbbd67a2027371870cee77acdaa8cf9563990816d8"
udp1_msg = "dceb690a884d2c8db173945208004500004b1f760000801100000a0000bf9df0f53ac189c41400379e32906f0470ca41079785e59f0ebede00032286a2d531001310ff00000035870a4e07f6859ad24043fd9b0d23c75aa5f2"
udp2_msg = "dceb690a884d2c8db173945208004500004a1f790000801100000a0000bf9df0f53ac189c41400369e31906f0471ca410b5785e59f0ebede00032286b88531001410ff000000a0e3531000282c0c59c963855901a710a7f7"
n = 4

quic1="4500043a262a00004011736a0a00008c11f9c09a40090d990426ee0d6000041a015bf81901f81a01000390643011000369d892e7f819421800010000000092c9e5a747acf9b023c7a5d73f0968af9a1fc856c51c89bb95baa26c85d7fd8c9997440f14af76fba13fa9568d6a6d859f5fe5f9ee34130bd49c842d74df5616f65d05187645424a5bf7bb6dbb3f9ead6d77e5f2ce5af3d5034f79b582f8d3604b23b2eaf3e4c975b16eab9c553eda73753aea8bec6b6eebadd0541ee2cc7bb831eb568c3f5a0eec2a55db109c024c36a38399cfe52672b177091eb0d66cfad7f12c6f4dfbbedd44c6bb1d09c120dadbf6c3a48a8c03af1be9ed2ebcfa1edd3d808dca02f27f5b8b26de69985d757bcef2c525f6b0565b2adfd4080c8d674d463eaacaddd3bc94a03753a31b14a36eb2d1d95632e6f7e97edef35a923b3d4eb6cf16687b17dd7e0a4e3ecb7767b0a4d8db776a2086d305c77886a1895430c936fbc1862668b281ac73b167757b5d071ed071e21902e1a02b1634ca233cb348efc78e0c3ae461cd87d4c715ccc8c6673720851b455150e9f39cfe60dfbedc6f54722cf1acfbb8b77661bcd1dd764291e5a09d83954e9b8a984184d34963e0c3fd4f367ac937b8480876f96942d100ccba46b23d434cf7df7a90dd13a40fe6a4521805388bf75f1c577348c9cea47db148a28c8dd4d854a82ca01b927eed78be70d33c4b1f18a6a3c64a463b8275f000f93e276d48186574c1de99ee147cbc406dd5037d11deea9a74a17aae93534677742c3032399098def546a045385111cb94191ec3d7d211182ec8eb999ba9bf84e89d844d45ab953b007968b9f2b35d5a68b9db1b951f961a0d0a5f1f0825447259c1abb651604f0d87cbb21d44f18cf4bffd290babd28f093a27c93ce9e42729261800128e525d6589b98a19946a68d1a2b2fd7c6cd43a7f32069ed9917230af8bc84f2079b80ade38b3354dfb7750ce3871a421a45f8a76e062282065a69a118865c23bc297430be7e8b586f07b486ad08b1adb31ded3d071a53d519f1256232329c4df6ca046e135913a5f4266b500688ce13082076800e9732021df7802cb637782dd359f3ac93b5a1104a5e2cdbb9f1a93d4e685ef7d459284e0ad3f9ff3f6f55f155ccbdb624bf26053b6441adb44570acd3f88ca3ecd96d11d8bb43eea93aa02011acd0ac8223473798a334d12ff581d35851f2ea5a8bb76d40bef5fd61b6a854869e36e0fa4a778967215eeddcc8ab6a5c42a0e24302f1a7a152c6debe3bdb3e56b794a1a8a8a758419362219bc001e3e024d8721a8df2953e97d7ea6ac493e2eba2ec27c9e88463aca3ace2eab9073bf530ef67db33342fbe795dc1967509b49f6baf69707fceb5165508edddc158ce40dd04749f56f0a275411bf9893c640fc7464f2c8c00f176a3392119437b9659e355dd54edc73236d7c8583ecd27c1f54c2b6dcd1ebbad2845ec10cd9f9f4f725ed19653987940bb6eada3d442595d8047010320c0b00000000"
quic2="4500043afc78000040119d1b0a00008c11f9c09a40090d99042644e06000041a015bf81901f81a01000390e43012000369d892e7f819421800010000000009d52f2a932e65d824a8f147096376575b6ef0f98a45ceaa1409ba55658d17cb8d5ca74bc3ed43d6026f9b2aa042bfdbb14fd8414cec53ed4da3074fd0bb213d1acbe36a1b3074cae32f90c4f7c78c03658d990d7489bb7aa888b3f7913a96edfdb49228f6bbddd9cd6113199975a16ec6da8b68c50eebf410b05226d15a5bb50562d63ffcd6c858da24d39c5bfb18df59a7f9e2c975fac442c59df399953bafda761e2ecce303baf0510c3e004f431af63aa39c354d5d08817c0d6d3c21c78ffd635dc391e47e0e60ea0b9da2bbfde247672f2c7243651bf8486aa197adde2f9d15dbff93f521774ba6aeddbd5806887ac01cd94735deebcb83d6572c5887e50b3b7672746e954836752b8f4b91b09857d77dccebc67a4c08d6e58a4aa4495c04f33b5697528ba5808426aa012ce0c55aa5947ab092e04a258cd3705cd2c1bba613589af68b258ff4bf3ab1f928e3caa03f713283ab700a5f4a43411da63c4f622ca9ac09c3942512a11c7c95f36868257da57510684556d4e7692ffca7c79e6f0b1b83c94b9c2500dd9a656861ff5c06cd31f9fa16a09e88e55efbfc44f468fcd03080a0aec17d081ea6d9ca2dd56742f45da6bd9daadd2125f5716b6a655ad65a598ffd0c2a2837a0ed9a83c2ce061d2e1a398b4938e88e67a647b9bfbbee29538d06fe6e24e45cfc3111ac822b75682fecb7acc68e1477c91884151c419fb374983ce7e623703f4004dcdd78f883cdaf59003a5c32b7764fa738a791f3fa9748465ba3f50a57a6a22c8103168c1543d8647a4b6599e8e2ed1e0d1dde5f4e3356107ac4e6deddcf111318105a87a5758ccf1149b85aaadb68e034921e96ed770c0eb6f250275674f82accc70edeaa28ce8914c736a37990eb0e7d0b776b102b5462e5b1016bae0bc1f1af94b8b48d694931bae967f50d645f6c3d6249375f6013e41af001b40d3aa71f43d4d471e2869a86f6f476a4dd86fc0fa5738bed5bf2c6c48b14c72a08260004f2824dc5d22664e8c2d4b79423d99b97a9037eec2e86f527f377fee2d58376668e883713936ea2dabdbdece136c39aaeb78ebaca3554cff6723ba03dd3114e3e1593dd6411ac047a600b6ddc04f0a8b888f546f877865c7579e9475e5a14393f000ea9d21b3318c36bfba0cdb473444f9def54d4108f25bf29caef514774c78481d9ec5bd2cecd907155788312238e1f90e787f28db83aa1f1bde517d9e0c99840a828c7bc1db6d377fe8a0a3b6db8a22eeeccfa43d8198c615ee6ac88b2c2a4d8ed4b17e7e694cde503770cf47af0dd4b727a408c2140e04fc98ccd14ac38133d668478faa6aee1151bde33481364c40f7ade226f8e07a0a2e986391d42930d0f34fff62e922c55c8281783309073f703ecbc0aaeb9f7c83bb3614930940bb6eada3d442595d8047010320c0b00000000"



out1, out2 = highlight_common_sequences(
    quic1, quic2, n)
# 7a526739 3a 41777758 = zRg9:AwwX
# 41777758 3a 7a526739 = AwwX:zRg9
# messgae cookie 2112a442
print("\nstring1 =\n", out1)
# print_six_columns(out1)
print("\nstring2 =\n", out2)
# print_six_columns(out2)
